<!-- Map centré sur Strasbourg inter monuments
          styles      -->
          <style>
            #chartdivStrasbourg {
              width: 80%;
              height: 700px;
            }
            </style>
            
        
            <!-- Chart code -->
            <script>
            am5.ready(function() {
        
            // Create rootStrasbourg element
            // https://www.amcharts.com/docs/v5/getting-started/#rootStrasbourg_element
            var rootStrasbourg = am5.Root.new("chartdivStrasbourg");
            
            
            // Set themes
            // https://www.amcharts.com/docs/v5/concepts/themes/
            rootStrasbourg.setThemes([
              am5themes_Animated.new(rootStrasbourg),
              am5themes_Responsive.new(rootStrasbourg),
            ]);
            
            
            // Create the map chart
            // https://www.amcharts.com/docs/v5/charts/map-chart/
            var chart = rootStrasbourg.container.children.push(am5map.MapChart.new(rootStrasbourg, {
              panX: "translateX",
              panY: "translateY",
              positionX: 46,
              rotationY: 2,
              projection: am5map.geoMercator()
            }));
        
            var cont = chart.children.push(am5.Container.new(rootStrasbourg, {
              layout: rootStrasbourg.horizontalLayout,
              x: 20,
              y: 40
            }));
            
            
            // Add labels and controls
            cont.children.push(am5.Label.new(rootStrasbourg, {
              centerY: am5.p50,
              text: "Map"
            }));
            
            var switchButton = cont.children.push(am5.Button.new(rootStrasbourg, {
              themeTags: ["switch"],
              centerY: am5.p50,
              icon: am5.Circle.new(rootStrasbourg, {
                themeTags: ["icon"]
              })
            }));
            
            switchButton.on("active", function() {
              if (!switchButton.get("active")) {
                chart.set("projection", am5map.geoMercator());
                chart.set("panX", "translateX");
                chart.set("panY", "translateY");
              }
              else {
                chart.set("projection", am5map.geoOrthographic());
                chart.set("panX", "rotateX");
                chart.set("panY", "rotateY");
              }
            });
            
            cont.children.push(am5.Label.new(rootStrasbourg, {
              centerY: am5.p50,
              text: "Globe"
            }));
            
            // Create main polygon series for countries
            // https://www.amcharts.com/docs/v5/charts/map-chart/map-polygon-series/
            var polygonSeries = chart.series.push(am5map.MapPolygonSeries.new(rootStrasbourg, {
              geoJSON: am5geodata_worldLow
            }));
        
            
            var graticuleSeries = chart.series.push(am5map.GraticuleSeries.new(rootStrasbourg, {}));
            graticuleSeries.mapLines.template.setAll({
              stroke: rootStrasbourg.interfaceColors.get("alternativeBackground"),
              strokeOpacity: 0.08
            });
            
            // Create line series for trajectory lines
            // https://www.amcharts.com/docs/v5/charts/map-chart/map-line-series/
            var lineSeries = chart.series.push(am5map.MapLineSeries.new(rootStrasbourg, {}));
            lineSeries.mapLines.template.setAll({
              stroke: rootStrasbourg.interfaceColors.get("alternativeBackground"),
              strokeOpacity: 0.6,
              strokeWidth: 5,
            });
            
            // destination series
            var citySeries = chart.series.push(
              am5map.MapPointSeries.new(rootStrasbourg, {})
            );
            
            citySeries.bullets.push(function() {
              var circle = am5.Circle.new(rootStrasbourg, {
                radius: 5,
                tooltipText: "{title}",
                tooltipY: 0,
                fill: am5.color(0xffba00),
                stroke: rootStrasbourg.interfaceColors.get("background"),
                strokeWidth: 2
              });
            
              return am5.Bullet.new(rootStrasbourg, {
                sprite: circle
              });
            });
            
            // arrow series
            var arrowSeries = chart.series.push(
              am5map.MapPointSeries.new(rootStrasbourg, {})
            );
            
            arrowSeries.bullets.push(function() {
              var arrow = am5.Graphics.new(rootStrasbourg, {
                fill: am5.color(0x000000),
                stroke: am5.color(0x000000),
                draw: function (display) {
                  display.moveTo(0, -3);
                  display.lineTo(8, 0);
                  display.lineTo(0, 3);
                  display.lineTo(0, -3);
                }
              });
            
              return am5.Bullet.new(rootStrasbourg, {
                sprite: arrow
              });
            });
            
            var cities = [
            {
    
                id: "belgique",
                title: "Belgique",
                geometry: { type: "Point", coordinates: [3.97, 50.86] },
                },
                {
                id: "canada",
                title: "Canada",
                geometry: { type: "Point", coordinates: [-112, 60] }
                }, 
                {
                id: "espagne",
                title: "Espagne",
                geometry: { type: "Point", coordinates: [-3.81, 40.43] }
                },
                {
                id: "luxembourg",
                title: "Luxembourg",
                geometry: { type: "Point", coordinates: [6.02, 49.74] }
                }, 
                {
                id: "suisse",
                title: "Suisse",
                geometry: { type: "Point", coordinates: [7.90, 46.61] }
                },
                {
                id: "cat strasbourg",
                title: "Cathédrale Notre Dame de Strasbourg",
                geometry: { type: "Point", coordinates: [7.7485755, 48.5817555] },
              }];
            
            citySeries.data.setAll(cities);
            
            // prepare line series data
            var destinations = ["belgique","canada","espagne","luxembourg","suisse"];
            // Strasbourg coordinates
            var originLongitude = 7.7485755;
            var originLatitude = 48.5817555;
            
            
            // Strasbourg -- Belgique
            am5.array.each(destinations, function (did) {
              var destinationDataItem = citySeries.getDataItemById(did);
              var lineDataItem = lineSeries.pushDataItem({ orientation: "vertical", geometry: { type: "LineString", coordinates: [[originLongitude, originLatitude], [3.97, 50.86]] } }); //[destinationDataItem.get("longitude"), destinationDataItem.get("latitude")]]
        
              arrowSeries.pushDataItem({
                lineDataItem: lineDataItem,
                positionOnLine: 0.5,
                autoRotate: true,
              });
            })
        
            // Strasbourg -- Canada
            am5.array.each(destinations, function (did) {
              var destinationDataItem = citySeries.getDataItemById(did);
              var lineDataItem = lineSeries.pushDataItem({ orientation: "vertical", geometry: { type: "LineString", coordinates: [[originLongitude, originLatitude], [-112, 60]] } }); //[destinationDataItem.get("longitude"), destinationDataItem.get("latitude")]]
        
              arrowSeries.pushDataItem({
                lineDataItem: lineDataItem,
                positionOnLine: 0.5,
                autoRotate: true,
              });
            })
        
            // Strasbourg -- Espagne
            am5.array.each(destinations, function (did) {
              var destinationDataItem = citySeries.getDataItemById(did);
              var lineDataItem = lineSeries.pushDataItem({ orientation: "vertical", geometry: { type: "LineString", coordinates: [[originLongitude, originLatitude], [-3.81, 40.43]] } }); //[destinationDataItem.get("longitude"), destinationDataItem.get("latitude")]]
        
              arrowSeries.pushDataItem({
                lineDataItem: lineDataItem,
                positionOnLine: 0.5,
                autoRotate: true,
              });
            })

            // Strasbourg -- Luxembourg
            am5.array.each(destinations, function (did) {
              var destinationDataItem = citySeries.getDataItemById(did);
              var lineDataItem = lineSeries.pushDataItem({ orientation: "vertical", geometry: { type: "LineString", coordinates: [[originLongitude, originLatitude], [6.02, 49.74]] } }); //[destinationDataItem.get("longitude"), destinationDataItem.get("latitude")]]
        
              arrowSeries.pushDataItem({
                lineDataItem: lineDataItem,
                positionOnLine: 0.5,
                autoRotate: true,
              });
            })


            // Strasbourg -- Suisse
            am5.array.each(destinations, function (did) {
              var destinationDataItem = citySeries.getDataItemById(did);
              var lineDataItem = lineSeries.pushDataItem({ orientation: "vertical", geometry: { type: "LineString", coordinates: [[originLongitude, originLatitude], [7.90, 46.61]] } }); //[destinationDataItem.get("longitude"), destinationDataItem.get("latitude")]]
        
              arrowSeries.pushDataItem({
                lineDataItem: lineDataItem,
                positionOnLine: 0.5,
                autoRotate: true,
              });
            })
        
         
            
            polygonSeries.events.on("datavalidated", function () {
              chart.zoomToGeoPoint({ longitude: 2, latitude: 48 }, 15);
            })
            
            
            // Make stuff animate on load
            chart.appear(1000, 100);
            
            }); // end am5.ready()
            </script>
        
            <!-- HTML -->
            <div id="chartdivStrasbourg"></div>