
            am5.ready(function() {
        
            // Create rootStMichel element
            // https://www.amcharts.com/docs/v5/getting-started/#rootStMichel_element
            var rootStMichel = am5.Root.new("chartdivStMichel");
            
            
            // Set themes
            // https://www.amcharts.com/docs/v5/concepts/themes/
            rootStMichel.setThemes([
              am5themes_Animated.new(rootStMichel),
              am5themes_Responsive.new(rootStMichel),
            ]);
            
            
            // Create the map chart
            // https://www.amcharts.com/docs/v5/charts/map-chart/
            var chart = rootStMichel.container.children.push(am5map.MapChart.new(rootStMichel, {
              panX: "translateX",
              panY: "translateY",
              positionX: 46,
              rotationY: 2,
              projection: am5map.geoMercator()
            }));
        
            var cont = chart.children.push(am5.Container.new(rootStMichel, {
              layout: rootStMichel.horizontalLayout,
              x: 20,
              y: 40
            }));
            
            
            // Add labels and controls
            cont.children.push(am5.Label.new(rootStMichel, {
              centerY: am5.p50,
              text: "Map"
            }));
            
            var switchButton = cont.children.push(am5.Button.new(rootStMichel, {
              themeTags: ["switch"],
              centerY: am5.p50,
              icon: am5.Circle.new(rootStMichel, {
                themeTags: ["icon"]
              })
            }));
            
            switchButton.on("active", function() {
              if (!switchButton.get("active")) {
                chart.set("projection", am5map.geoMercator());
                chart.set("panX", "translateX");
                chart.set("panY", "translateY");
              }
              else {
                chart.set("projection", am5map.geoOrthographic());
                chart.set("panX", "rotateX");
                chart.set("panY", "rotateY");
              }
            });
            
            cont.children.push(am5.Label.new(rootStMichel, {
              centerY: am5.p50,
              text: "Globe"
            }));
            
            // Create main polygon series for countries
            // https://www.amcharts.com/docs/v5/charts/map-chart/map-polygon-series/
            var polygonSeries = chart.series.push(am5map.MapPolygonSeries.new(rootStMichel, {
              geoJSON: am5geodata_worldLow
            }));
        
            
            var graticuleSeries = chart.series.push(am5map.GraticuleSeries.new(rootStMichel, {}));
            graticuleSeries.mapLines.template.setAll({
              stroke: rootStMichel.interfaceColors.get("alternativeBackground"),
              strokeOpacity: 0.08
            });
            
            // Create line series for trajectory lines
            // https://www.amcharts.com/docs/v5/charts/map-chart/map-line-series/
            var lineSeries = chart.series.push(am5map.MapLineSeries.new(rootStMichel, {}));
            lineSeries.mapLines.template.setAll({
              stroke: rootStMichel.interfaceColors.get("alternativeBackground"),
              strokeOpacity: 0.6,
              strokeWidth: 5,
            });
            
            // destination series
            var citySeries = chart.series.push(
              am5map.MapPointSeries.new(rootStMichel, {})
            );
            
            citySeries.bullets.push(function() {
              var circle = am5.Circle.new(rootStMichel, {
                radius: 5,
                tooltipText: "{title}",
                tooltipY: 0,
                fill: am5.color(0xffba00),
                stroke: rootStMichel.interfaceColors.get("background"),
                strokeWidth: 2
              });
            
              return am5.Bullet.new(rootStMichel, {
                sprite: circle
              });
            });
            
            // arrow series
            var arrowSeries = chart.series.push(
              am5map.MapPointSeries.new(rootStMichel, {})
            );
            
            arrowSeries.bullets.push(function() {
              var arrow = am5.Graphics.new(rootStMichel, {
                fill: am5.color(0x000000),
                stroke: am5.color(0x000000),
                draw: function (display) {
                  display.moveTo(0, -3);
                  display.lineTo(8, 0);
                  display.lineTo(0, 3);
                  display.lineTo(0, -3);
                }
              });
            
              return am5.Bullet.new(rootStMichel, {
                sprite: arrow
              });
            });
            
            var cities = [
            {
                id: "australie",
                title: "Australie",
                geometry: { type: "Point", coordinates: [133, -23] }
                },
                {
                id: "belgique",
                title: "Belgique",
                geometry: { type: "Point", coordinates: [3.97, 50.86] },
                },
                {
                id: "canada",
                title: "Canada",
                geometry: { type: "Point", coordinates: [-112, 60] }
                }, {
                id: "etatsunis",
                title: "Ã‰tats-Unis",
                geometry: { type: "Point", coordinates: [-88.01, 41.83] }
                }, 
                {
                id: "suisse",
                title: "Suisse",
                geometry: { type: "Point", coordinates: [7.90, 46.61] }
                },
                {
                id: "saint michel",
                title: "Abbaye du Mont-Saint-Michel",
                geometry: { type: "Point", coordinates: [-1.510278, 48.636391] },
              }];
            
            citySeries.data.setAll(cities);
            
            // prepare line series data
            var destinations = ["australie","belgique","canada","etatsunis","suisse"];
            // Saint Michel coordinates
            var originLongitude = -1.510278;
            var originLatitude = 48.636391;
            
            // Saint Michel -- Australie 
            am5.array.each(destinations, function (did) {
            var destinationDataItem = citySeries.getDataItemById(did);
            var lineDataItem = lineSeries.pushDataItem({ orientation: "vertical", geometry: { type: "LineString", coordinates: [[originLongitude, originLatitude], [133, -23]] } }); //[destinationDataItem.get("longitude"), destinationDataItem.get("latitude")]]
        
            arrowSeries.pushDataItem({
              lineDataItem: lineDataItem,
              positionOnLine: 0.5,
              autoRotate: true,
            });
          })
        
            // Saint Michel -- Belgique
            am5.array.each(destinations, function (did) {
              var destinationDataItem = citySeries.getDataItemById(did);
              var lineDataItem = lineSeries.pushDataItem({ orientation: "vertical", geometry: { type: "LineString", coordinates: [[originLongitude, originLatitude], [3.97, 50.86]] } }); //[destinationDataItem.get("longitude"), destinationDataItem.get("latitude")]]
        
              arrowSeries.pushDataItem({
                lineDataItem: lineDataItem,
                positionOnLine: 0.5,
                autoRotate: true,
              });
            })
        
            // Saint Michel -- Canada
            am5.array.each(destinations, function (did) {
              var destinationDataItem = citySeries.getDataItemById(did);
              var lineDataItem = lineSeries.pushDataItem({ orientation: "vertical", geometry: { type: "LineString", coordinates: [[originLongitude, originLatitude], [-112, 60]] } }); //[destinationDataItem.get("longitude"), destinationDataItem.get("latitude")]]
        
              arrowSeries.pushDataItem({
                lineDataItem: lineDataItem,
                positionOnLine: 0.5,
                autoRotate: true,
              });
            })
        
            // Saint Michel -- Etatsunis
            am5.array.each(destinations, function (did) {
              var destinationDataItem = citySeries.getDataItemById(did);
              var lineDataItem = lineSeries.pushDataItem({ orientation: "vertical", geometry: { type: "LineString", coordinates: [[originLongitude, originLatitude], [-88.01, 41.83]] } }); //[destinationDataItem.get("longitude"), destinationDataItem.get("latitude")]]
        
              arrowSeries.pushDataItem({
                lineDataItem: lineDataItem,
                positionOnLine: 0.5,
                autoRotate: true,
              });
            })
        
            // Saint Michel -- Suisse
            am5.array.each(destinations, function (did) {
              var destinationDataItem = citySeries.getDataItemById(did);
              var lineDataItem = lineSeries.pushDataItem({ orientation: "vertical", geometry: { type: "LineString", coordinates: [[originLongitude, originLatitude], [7.90, 46.61]] } }); //[destinationDataItem.get("longitude"), destinationDataItem.get("latitude")]]
        
              arrowSeries.pushDataItem({
                lineDataItem: lineDataItem,
                positionOnLine: 0.5,
                autoRotate: true,
              });
            })
        
         
            
            polygonSeries.events.on("datavalidated", function () {
              chart.zoomToGeoPoint({ longitude: 2, latitude: 48 }, 15);
            })
            
            
            // Make stuff animate on load
            chart.appear(1000, 100);
            
            }); // end am5.ready()
